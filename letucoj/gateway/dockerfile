FROM debian:bookworm-slim

# 仅用稳定源安装 Java 17
RUN set -eux; \
    apt-get update; \
    apt-get install -y --no-install-recommends \
        openjdk-17-jre-headless; \
    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \
           /usr/share/doc/* /usr/share/man/* /usr/share/info/*

WORKDIR /app
COPY gateway.jar /app/
RUN chmod +x /app/gateway.jar

ENV JAVA_OPTS="-Xms256m -Xmx512m -XX:+UseContainerSupport"
EXPOSE 7777
CMD ["sh", "-c", "exec java $JAVA_OPTS -jar /app/gateway.jar"]
